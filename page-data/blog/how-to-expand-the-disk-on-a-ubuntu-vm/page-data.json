{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-slug-tsx","path":"/blog/how-to-expand-the-disk-on-a-ubuntu-vm/","result":{"data":{"markdownRemark":{"html":"<p>I assure you, this blog post is more for me than it is for you. I can't begin to explain how many different times I have had to expand the disk space of a VM on my Proxmox host, and struggled far too long on Google to get the answer.</p>\n<p>Sure, there's some different packages that you could install from the normal Ubuntu repositories to make this a super simple and almost thoughtless process, but what if your disk is completely full and that isn't an option?</p>\n<p>The following is a quick and painless step by step guide to expand the disk on your Ubuntu virtual machine. This should be especially useful if you, for example, ran out of disk space and can't install any more packages.</p>\n<p>We'll assume that you have already added the disk space to your VM on your host machine and that you've already rebooted your VM.</p>\n<h2>Parted</h2>\n<p>Parted is a command line utility that comes pre installed on Ubuntu 18.04. Parted can view and edit the partitions on your disk. We'll be using it to reorganize our disk space so that Ubuntu can see the newly added space on our disk.</p>\n<p>For our purposes, parted must be run with the <code>sudo</code> command</p>\n<p>This command will open the program:</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">sudo parted</code>\n        </deckgo-highlight-code>\n<p>Executing the print command will show all partitions of the disk:</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">print all</code>\n        </deckgo-highlight-code>\n<p>As soon as you type this command you will be greeted with a message that shows that we have unused disk space, perfect!</p>\n<p><img src=\"https://billyjacoby.com/content/images/2020/05/parted-fix.png\" alt=\"\"></p>\n<p>Enter <code>F</code> or <code>Fix</code> to allow parted to fix the partition on the disk:</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">Fix</code>\n        </deckgo-highlight-code>\n<p>This is all we will need to do in parted. Enter <code>q</code> to exit the utility.</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">q</code>\n        </deckgo-highlight-code>\n<h2>Fdisk</h2>\n<p>Next we will be using <code>fdisk</code> to actually expand the new space to fill the rest of the drive.</p>\n<p>Replace the \"sda\" in the following command with wherever your disk is mounted:</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">sudo fdisk /dev/sda</code>\n        </deckgo-highlight-code>\n<p>The <code>p</code> command prints the current partition table:</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">p</code>\n        </deckgo-highlight-code>\n<p>Now type <code>d</code> to delete your existing partition - as scary as it sounds this is just so that it can be replaced with a larger partition that's the size of the whole disk. It will also ask which partition to delete. Make sure that the one you are selecting is correct.</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">d</code>\n        </deckgo-highlight-code>\n<p>The <code>n</code> command will create a new partition that, in our case, will include all the existing space on the disk. It will ask you a series of questions including what number the disk should be labeled, and the first and last sectors on the disk. I have always just selected the defaults here.</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">n</code>\n        </deckgo-highlight-code>\n<p>Next you may be asked if you want to remove the signature on the drive. In my case, this means that there was already an ext4 formatted filesystem on this partition of the disk. I always choose to remove the previous signature here, but for some reason you may not want to.</p>\n<p><img src=\"https://billyjacoby.com/content/images/2020/05/fdisk-n.png\" alt=\"\"></p>\n<p>The final step is to write the partition to our disk. After you ensure that you've selected all the correct options type the <code>w</code> command to write the new partition!</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">w</code>\n        </deckgo-highlight-code>\n<h2>Resize2fs</h2>\n<p>And the final step in this process is to use the <code>resize2fs</code> utility to resize the filesystem so that it utilizes all of the space available on it.</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">sudo resize2fs /dev/sda2</code>\n        </deckgo-highlight-code>\n<p><img src=\"https://billyjacoby.com/content/images/2020/05/resize2fs.png\" alt=\"resize2fs\"></p>\n<p>After you've done this you can log out and back in to your machine to see that the percentage of used disk space has decreased!</p>\n<p>Thanks for reading!</p>","frontmatter":{"date":"May 20, 2020","slug":"/blog/how-to-expand-the-disk-on-a-ubuntu-vm","title":"How to expand the disk on a Ubuntu VM"}}},"pageContext":{"id":"1d1359be-c77f-543c-9e05-d9cd424f6c9f","frontmatter__slug":"/blog/how-to-expand-the-disk-on-a-ubuntu-vm","__params":{"frontmatter__slug":"blog"}}},"staticQueryHashes":[]}
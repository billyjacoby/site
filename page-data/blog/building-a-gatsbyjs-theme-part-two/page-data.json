{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-slug-tsx","path":"/blog/building-a-gatsbyjs-theme-part-two/","result":{"data":{"markdownRemark":{"html":"<h2>Designing and configuring our Layout</h2>\n<p>This is part two in a multi-part tutorial series on building your own Gatsby theme from scratch.</p>\n<p>Please checkout the <a href=\"https://billyjacoby.dev/intro-to-gatsby-themes\">Introduction</a> and <a href=\"https://billyjacoby.dev/building-a-gatsbyjs-theme-part-one\">Part One</a> of this series if you haven't yet, as we will be picking up right where we left off at the end of part one.</p>\n<p>The finished code for this portion of the tutorial can be found on my github repo <a href=\"https://github.com/billyjacoby/gabsty-theme-tutorial/tree/part-two\">here.</a></p>\n<p>Here's what we'll be tackling in this part of the tutorial:</p>\n<ul>\n<li>Create a layout component</li>\n<li>Enable our Layout component to work across all pages</li>\n<li>Create a Header component that gets site metadata</li>\n<li>Put our Header in our Layout component to be shown on all pages</li>\n</ul>\n<h3>Create a layout component</h3>\n<p>So the first step in styling our theme is going to be building a main Layout component. We'll do this the same way you would build any other Layout component in Gatsby. We'll be building our styles in their own folders and importing them into our components. You can do the same, or use CSS in JS as well.</p>\n<p>In your theme directory create a file named <code>layout.js</code> in a <code>gatsby-theme-tutorial/src/components/</code> directory.</p>\n<p>Layout components in Gatsby take in a <code>{children}</code> object, build their layout around this object, and render the children passed into the Layout component. This is how you would do some basic styling in a Layout component in gatsby:</p>\n<p><strong><em>All of styles are only to show how this works, we will clean all of these up in a later tutorial</em></strong></p>\n<p><strong><code>/packages/gatsby-theme-tutorial/src/styles/layout.css</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">.container {\n  margin: -8px;\n  padding: 8px;\n  background-color: tomato;\n  font-family: Verdana, Geneva, Tahoma, sans-serif;\n  width: 100%;\n}\n\nmain {\n  display: flex;\n  height: 100vh;\n  justify-content: center;\n  align-items: center;\n}</code>\n        </deckgo-highlight-code>\n<p><strong><code>/packages/gatsby-theme-tutorial/src/components/layout.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">import React from &quot;react&quot;;\nimport &quot;../styles/layout.css&quot;;\n\nconst Layout = ({ children }) =&gt; {\n  return (\n    &lt;div className=&quot;container&quot;&gt;\n      &lt;main&gt;{children}&lt;/main&gt;\n    &lt;/div&gt;\n  );\n};\n\nexport default Layout;</code>\n        </deckgo-highlight-code>\n<p>Now the main difference in using a layout component in a normal Gatsby project, and a theme is that we want to make this layout available for all of the pages that may be built and not just the pages that come with our theme. To demonstrate this idea let's start by importing this layout file into our index.js file in our theme directory.</p>\n<p><strong><code>/packages/gatsby-theme-tutorial/src/pages/index.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">import React from &quot;react&quot;;\nimport Layout from &quot;../components/layout&quot;;\n\nexport default () =&gt; (\n  &lt;Layout&gt;\n    &lt;h1&gt;Hello World!&lt;/h1&gt;\n  &lt;/Layout&gt;\n);</code>\n        </deckgo-highlight-code>\n<p>Now lets add an About page to our site directory.</p>\n<p><strong><code>/site/src/pages/about.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">import React from &quot;react&quot;;\n\nconst AboutPage = () =&gt; {\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;About page!&lt;/h2&gt;\n    &lt;/div&gt;\n  );\n};\n\nexport default AboutPage;</code>\n        </deckgo-highlight-code>\n<p>Now lets start up our development server and see how our pages look.</p>\n<p><code>yarn workspace site develop</code></p>\n<p>After we navigate to <code>localhost:8000</code> you should see that our layout has taken effect!</p>\n<p>However, if we navigate to <code>localhost:8000/about</code> you'll notice that the layout isn't rendered. This is because we haven't imported the Layout component into this page.</p>\n<h3>Configuring our Layout to work across all pages</h3>\n<p>Now its possible to add our Layout component as an export to our theme package, which would enable users to import our Layout into all of the necessary pages. But we want to build a Gatsby theme to make development as easy as possible!</p>\n<p>What we can do instead is wrap the root element of every page that gets rendered in our layout component using Gatsby's <code>wrapRootElement</code>. This will add our Layout component to every page created without having to import it into our page files.</p>\n<p>Go ahead and revert your <code>index.js</code> back to just an H1 tag.</p>\n<p><strong><code>/packages/gatsby-theme-tutorial/src/pages/index.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">import React from &quot;react&quot;;\n\nexport default () =&gt; &lt;h1&gt;Hello World!&lt;/h1&gt;;</code>\n        </deckgo-highlight-code>\n<p>Next we'll create two more files in out root theme directory.</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">touch packages/gatsby-theme-tutorial/gatsby-browser.js\ntouch packages/gatsby-theme-tutorial/gatsby-ssr.js</code>\n        </deckgo-highlight-code>\n<p>Though it seems a little repetitive we will need to place the same code in both of these files. The reason for this is because this code will run either on the server side, or in the browser itself and regardless of where they run we still want our root element wrapped.</p>\n<p>So both our <code>gatsby-browser.js</code> and <code>gatsby-ssr.js</code> files should contain the following code:</p>\n<p><strong><code>/packages/gatsby-theme-tutorial/gatsby-browser.js</code></strong></p>\n<p>And</p>\n<p><strong><code>/packages/gatsby-theme-tutorial/gatsby-ssr.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">import React from &quot;react&quot;;\nimport Layout from &quot;./src/components/layout&quot;;\n\nexport const wrapPageElement = ({ element, props }) =&gt; {\n  // props provide same data to Layout as Page element will get\n  // including location, data, etc - you don&#39;t need to pass it\n  console.log(props);\n  return &lt;Layout {...props}&gt;{element}&lt;/Layout&gt;;\n};</code>\n        </deckgo-highlight-code>\n<p>Now if we check both our index and about pages we should see that our layouts have rendered!</p>\n<p>We can now begin building a site-wide header and navigation that will show up on every page, without having to import the layout component into each and every page.</p>\n<h3>Create a Header component that uses site metadata</h3>\n<p>Lets create a simple site header that displays the site name and a link to the home page.</p>\n<p>TO do this lets add some site information to the <code>gatsby-config.js</code> for our theme.</p>\n<p><strong><code>/packages/gatsby-theme-tutorial/gatsby-config.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">module.exports = {\n  siteMetadata: {\n    title: `Gatsby Theme Tutorial`,\n    description: `A tutorial for building a GatsbyJS theme from scratch!`\n  },\n  plugins: [\n    {\n      resolve: `gatsby-plugin-page-creator`,\n      options: {\n        path: `${__dirname}/src/pages`\n      }\n    }\n  ]\n};</code>\n        </deckgo-highlight-code>\n<p>Now in our Header component we need to query for our site title. We'll do this using the <code>useStaticQuery</code> hook that Gatsby provides. We can then take that info and use it in our component.</p>\n<p><strong><code>/packages/gatsby-theme-tutorial/src/components/header.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">import React from &quot;react&quot;;\nimport { useStaticQuery, graphql, Link } from &quot;gatsby&quot;;\n\nimport &quot;../styles/header.css&quot;;\n\nconst Header = () =&gt; {\n  const data = useStaticQuery(graphql`\n    query {\n      site {\n        siteMetadata {\n          title\n          description\n        }\n      }\n    }\n  `);\n\n  return (\n    &lt;div className=&quot;header&quot;&gt;\n      &lt;Link to=&quot;/&quot; className=&quot;no-style&quot;&gt;\n        &lt;h1 className=&quot;site-heading&quot;&gt;{data.site.siteMetadata.title}&lt;/h1&gt;\n        &lt;h4&gt;{data.site.siteMetadata.description}&lt;/h4&gt;\n      &lt;/Link&gt;\n    &lt;/div&gt;\n  );\n};\n\nexport default Header;</code>\n        </deckgo-highlight-code>\n<p><strong><code>/packages/gatsby-theme-tutorial/src/styles/header.css</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">.header {\n  margin: -8px;\n  padding: 1.5rem;\n  width: 100%;\n  align-self: center;\n  text-align: center;\n  background-color: purple;\n  font-family: Arial, Helvetica, sans-serif;\n  border-bottom: solid black;\n}\n\n.site-heading {\n  font-size: 3rem;\n}\n\n.no-style {\n  color: inherit;\n  text-decoration: inherit;\n}</code>\n        </deckgo-highlight-code>\n<p>This is great! Noe we can access our site metadata from our <code>gatbsy-config.js</code> file in our header component. The real magic happens when we add and change this file in our site folder.</p>\n<p><strong><code>/site/gatsby-config.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">module.exports = {\n  siteMetadata: {\n    title: `New Gatsby Site`,\n    description: `A website using our Gatsby theme!`\n  },\n  __experimentalThemes: [&quot;gatsby-theme-tutorial&quot;]\n};</code>\n        </deckgo-highlight-code>\n<p>And now the header will contain the data configured in our site folder instead of the theme folder!</p>\n<p>Now lets add our Header to our Layout component.</p>\n<h3>Adding our Header to our Layout</h3>\n<p>All we have to do is import our <code>header.js</code> file into our <code>layout.js</code> component and place it accordingly.</p>\n<p><strong><code>/packages/gatsby-theme-tutorial/components/layout.js</code></strong></p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"synthwave\"  >\n          <code slot=\"code\">import React from &quot;react&quot;;\nimport &quot;../styles/layout.css&quot;;\n\nimport Header from &quot;./header&quot;;\n\nconst Layout = ({ children }) =&gt; {\n  return (\n    &lt;div className=&quot;container&quot;&gt;\n      &lt;Header /&gt;\n      &lt;main&gt;{children}&lt;/main&gt;\n    &lt;/div&gt;\n  );\n};\n\nexport default Layout;</code>\n        </deckgo-highlight-code>\n<p>Our header will now be displayed on every page created either in the site folder or the theme folder.</p>\n<h3>Wrapping Up</h3>\n<p>Building components in our Gatsby theme allows us to build fully styled components while giving the consumers of the theme control over the content with ease.</p>\n<p>We're just scratching the surface on building this Gatsby theme, but you can already see the potential for complete customization!</p>\n<p>If something isn't working as you would expect feel free to compare your code against the code in the repo for this part of the tutorial <a href=\"https://github.com/billyjacoby/gabsty-theme-tutorial/tree/part-two\">here.</a></p>\n<p>Feel free to comment or tweet at me with any questions you might have, or with suggestions for what to cover in a future tutorial.</p>\n<h3>What's Next</h3>\n<p>In part three of this tutorial we will begin building different styles for different sections of our theme (blog, store, etc…), as well as how we can override styles and whole components from the site that is using our theme.</p>\n<p>The possibilities are endless when it comes to end-user customization with Gatsby themes. We'll also see how little boilerplate code we need to build full websites on a Gatsby theme!</p>","frontmatter":{"date":"May 25, 2019","slug":"/blog/building-a-gatsbyjs-theme-part-two","title":"Building a GatsbyJS Theme - Part Two"}}},"pageContext":{"id":"fffd003b-8c88-5b75-8770-39a0577906e4","frontmatter__slug":"/blog/building-a-gatsbyjs-theme-part-two","__params":{"frontmatter__slug":"blog"}}},"staticQueryHashes":[]}
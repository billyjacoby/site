<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.17.2"/><style data-href="/styles.29a9445ec27993ac83f0.css" data-identity="gatsby-global-css">@font-face{font-family:Inter;font-weight:100 1000;src:url(/static/Inter-VariableFont_slnt,wght-b4c30855aff392d7e8dc5de4c692684d.ttf) format("woff2-variations")}@font-face{font-family:Fira;font-weight:100 1000;src:url(/static/FiraCode-VariableFont_wght-4938e54ab2f06530a08416c117c08e98.ttf) format("woff2-variations")}:root{--primary-background:#1d1d1d;--secondary-background:#636363;--primary-font:#fff;--accent:#5dea51;--accent-2:#611991}*,:after,:before{box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;-ms-box-sizing:border-box}html{background-color:var(--primary-background);color:var(--primary-font);font-family:Inter;font-size:16px}body{margin:0}.my-masonry-grid{display:flex;margin-left:-1rem;width:auto}.my-masonry-grid_column{background-clip:padding-box;padding-left:1rem}</style><style data-styled="" data-styled-version="5.3.5">.bFxuSp{max-width:1000px;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
.bFxuRb{max-width:1200px;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
data-styled.g6[id="Components__Container-sc-d0qytj-5"]{content:"bFxuSp,bFxuRb,"}/*!sc*/
.fgsjJZ{-webkit-text-decoration:none;text-decoration:none;font-family:Fira;font-size:1.35rem;color:var(--accent);}/*!sc*/
data-styled.g7[id="Components__StyledWebsiteName-sc-d0qytj-6"]{content:"fgsjJZ,"}/*!sc*/
.gEBbCI{-webkit-text-decoration:none;text-decoration:none;color:inherit;}/*!sc*/
.gEBbCI:hover{color:var(--accent);}/*!sc*/
data-styled.g9[id="Components__StyledLink-sc-d0qytj-8"]{content:"gEBbCI,"}/*!sc*/
.dEwWNT{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}/*!sc*/
data-styled.g10[id="Navbar__RightContent-sc-1ohjj95-0"]{content:"dEwWNT,"}/*!sc*/
.kWvDoT{font-size:0.875rem;}/*!sc*/
data-styled.g11[id="Navbar__RightSubtext-sc-1ohjj95-1"]{content:"kWvDoT,"}/*!sc*/
.gHVmei{height:100%;max-width:1200px;margin:0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 1rem;}/*!sc*/
data-styled.g12[id="Navbar__NavbarContainer-sc-1ohjj95-2"]{content:"gHVmei,"}/*!sc*/
.egdjOs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:1rem;}/*!sc*/
@media (max-width:768px){.egdjOs{margin-top:1rem;}}/*!sc*/
data-styled.g13[id="Footer__RightFooter-sc-p7cnj8-0"]{content:"egdjOs,"}/*!sc*/
.MgiYm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;max-width:65%;}/*!sc*/
@media (max-width:768px){.MgiYm{max-width:100%;margin-top:2rem;-webkit-order:2;-ms-flex-order:2;order:2;}}/*!sc*/
data-styled.g14[id="Footer__LeftFooter-sc-p7cnj8-1"]{content:"MgiYm,"}/*!sc*/
.byTVWE{margin:auto;width:100%;padding:1rem 3rem;background:var(--primary-background);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (max-width:768px){.byTVWE{max-width:100%;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}/*!sc*/
data-styled.g15[id="Footer__FooterContainer-sc-p7cnj8-2"]{content:"byTVWE,"}/*!sc*/
</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true"></title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Navbar__NavbarContainer-sc-1ohjj95-2 gHVmei"><div class="Navbar__RightContent-sc-1ohjj95-0 dEwWNT"><a class="Components__StyledWebsiteName-sc-d0qytj-6 fgsjJZ" href="/">billyjacoby.com</a><div class="Navbar__RightSubtext-sc-1ohjj95-1 kWvDoT">tutorials, thoughts, and tech</div></div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="64" width="64" xmlns="http://www.w3.org/2000/svg"><path d="M4 11h12v2H4zm0-5h16v2H4zm0 12h7.235v-2H4z"></path></svg></div><div class="Components__Container-sc-d0qytj-5 bFxuSp"><div class="blog-post-container"><h1>IntersectionObserver API with React Hooks</h1><h2>April 23, 2019</h2><div><p>A simple demo and tutorial showing how to simply use the intersection observer API with React Hooks</p>
<p>Here is a brief synopsis of what we will do:</p>
<ul>
<li>create-react-app</li>
<li>Initial project setup</li>
<li>intersection-observer polyfill</li>
<li>Add elements, update CSS</li>
<li>Write the hook</li>
<li>Initialize the state</li>
<li>Construct the IntersectionObserver instance</li>
<li>Ensure to only observe the element intersecting once</li>
<li>Show the hook in action, via the console</li>
</ul>
<p>If you want to see it in action checkout the demo <a href="https://billyjacoby.github.io/intersection-observer-hooks">here!</a><br>
(be sure to have the developer console open)</p>
<p>We'll demonstrate how this works on a simple <code>create-react-app</code> skeleton.</p>
<p>First thing we'll do is run:</p>
<deckgo-highlight-code  terminal="carbon" theme="synthwave"  >
          <code slot="code">create-react-app intersection-observer-hooks
cd intersection-observer-hooks</code>
        </deckgo-highlight-code>
<p>After the initialization we'll install the polyfill for the API, to ensure support for all browsers.</p>
<deckgo-highlight-code  terminal="carbon" theme="synthwave"  >
          <code slot="code">yarn add intersection-observer</code>
        </deckgo-highlight-code>
<p>Next we'll add a few elements to our app, and tweak the CSS to enable us to see how everything works</p>
<p><strong>App.js</strong></p>
<deckgo-highlight-code  terminal="carbon" theme="synthwave"  >
          <code slot="code">...
&lt;header className=&quot;App-header&quot;&gt;
      &lt;img src={logo} className=&quot;App-logo&quot; alt=&quot;logo&quot; /&gt;
      &lt;p&gt;
        Edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload.
      &lt;/p&gt;
      &lt;a
        className=&quot;App-link&quot;
        href=&quot;https://reactjs.org&quot;
        target=&quot;_blank&quot;
        rel=&quot;noopener noreferrer&quot;
      &gt;
        Learn React
      &lt;/a&gt;
    &lt;/header&gt;
&lt;div className=&quot;full-height one&quot;&gt;
      &lt;div className=&quot;item-one&quot; /&gt;
    &lt;/div&gt;
    &lt;div className=&quot;full-height two&quot;&gt;
      &lt;div className=&quot;item-two&quot; ref={elementRef}&gt;
        {inView &amp;&amp; &lt;p&gt;I&#39;m in view!&lt;/p&gt;}
      &lt;/div&gt;
    &lt;/div&gt;
    ...</code>
        </deckgo-highlight-code>
<p><strong>App.css</strong></p>
<deckgo-highlight-code  terminal="carbon" theme="synthwave"  >
          <code slot="code">... .full-height {
  height: 100vh;
  border: white dotted 1px;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.one {
  background-color: #61dafb;
  color: #282c34;
}

.two {
  background-color: #282c34;
  color: #61dafb;
}

.item-one {
  background-color: #282c34;
  color: #61dafb;
  height: 30%;
  width: 30%;
}

.item-two {
  color: #282c34;
  background-color: #61dafb;
  height: 30%;
  width: 30%;
}</code>
        </deckgo-highlight-code>
<p>Next we will create our hook in a separate file called <code>useIntersectionObserver.js</code></p>
<p>The first thing we'll do in this file is configure our hook to take the necessary parameters, configure out state, and output the information we'll want to see.</p>
<p><strong>useIntersectionObserver.js</strong></p>
<deckgo-highlight-code  terminal="carbon" theme="synthwave"  >
          <code slot="code">import { useState, useEffect } from &quot;react&quot;

export const useIntersectionObserver = (
  ref,
  { threshold, root, rootMargin }
) =&gt; {
  // configure the state
  const [state, setState] = useState({
    inView: false,
    triggered: false,
    entry: undefined,
  })

  return [state.inView, state.entry]
}</code>
        </deckgo-highlight-code>
<p>This hook will take a reference to the DOM node, and the options that you would like to pass in to the IntersectionObserver object; threshold, root, and rootMargin. For more information on what these options do, you can check out the MDN docs on the API <a href="https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/IntersectionObserver">here.</a></p>
<p>Now we'll configure our IntersectionObserver object, and write the callback function to update our state when our DOM node's intersectionRation is greater than 0.</p>
<p><strong>useIntersectionObserver.js</strong></p>
<deckgo-highlight-code  terminal="carbon" theme="synthwave"  >
          <code slot="code">...
const [state, setState] = useState({
    inView: false,
    triggered: false,
    entry: undefined
  });

  const observer = new IntersectionObserver(
    (entries, observerInstance) =&gt; {
      // checks to see if the element is intersecting
      if (entries[0].intersectionRatio &gt; 0) {
        // if it is update the state, we set triggered as to not re-observe the element
        setState({
          inView: true,
          triggered: true,
          entry: observerInstance
        });
        // unobserve the element
        observerInstance.unobserve(ref.current);
      }
      return;
    },
    {
      threshold: threshold || 0,
      root: root || null,
      rootMargin: rootMargin || &quot;0%&quot;
    }
  );
...</code>
        </deckgo-highlight-code>
<p>Next we'll use React's useEffect hook to ensure that the DOM node reference exists and also to make sure that the inView state has not already been triggered as true. This will finish up our hook, the finished result should look as follows:</p>
<p><strong>useIntersectionObserver.js</strong></p>
<deckgo-highlight-code  terminal="carbon" theme="synthwave"  >
          <code slot="code">import { useState, useEffect } from &quot;react&quot;

export const useIntersectionObserver = (
  ref,
  { threshold, root, rootMargin }
) =&gt; {
  // configure the state
  const [state, setState] = useState({
    inView: false,
    triggered: false,
    entry: undefined,
  })

  const observer = new IntersectionObserver(
    (entries, observerInstance) =&gt; {
      // checks to see if the element is intersecting
      if (entries[0].intersectionRatio &gt; 0) {
        // if it is update the state, we set triggered as to not re-observe the element
        setState({
          inView: true,
          triggered: true,
          entry: observerInstance,
        })
        // unobserve the element
        observerInstance.unobserve(ref.current)
      }
      return
    },
    {
      threshold: threshold || 0,
      root: root || null,
      rootMargin: rootMargin || &quot;0%&quot;,
    }
  )

  useEffect(() =&gt; {
    // check that the element exists, and has not already been triggered
    if (ref.current &amp;&amp; !state.triggered) {
      observer.observe(ref.current)
    }
  })

  return [state.inView, state.entry]
}</code>
        </deckgo-highlight-code>
<p>Now that we have written our hook, its time to import it into our app and see if its working.</p>
<p><strong>App.js</strong></p>
<deckgo-highlight-code  terminal="carbon" theme="synthwave"  >
          <code slot="code">...
import { useIntersectionObserver } from &quot;./useIntersectionObserver&quot;;

function App() {
  // Create the ref to our element
  const elementRef = useRef(null);
  const [inView, entry] = useIntersectionObserver(elementRef, {
    threshold: 0
  });

  // console.log our state everytime its updated to see if it works.
  useEffect(() =&gt; {
    console.log(inView);
  }, [inView]);

  return (
    &lt;div className=&quot;App&quot;&gt;
      &lt;header className=&quot;App-header&quot;&gt;
        &lt;img src={logo} className=&quot;App-logo&quot; alt=&quot;logo&quot; /&gt;
        &lt;p&gt;
          Edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload.
        &lt;/p&gt;
        &lt;a
          className=&quot;App-link&quot;
          href=&quot;https://reactjs.org&quot;
          target=&quot;_blank&quot;
          rel=&quot;noopener noreferrer&quot;
        &gt;
          Learn React
        &lt;/a&gt;
      &lt;/header&gt;
      &lt;div className=&quot;full-height one&quot;&gt;
        &lt;div className=&quot;item-one&quot; /&gt;
      &lt;/div&gt;
      &lt;div className=&quot;full-height two&quot;&gt;
        &lt;div className=&quot;item-two&quot; ref={elementRef}&gt;
          {inView &amp;&amp; &lt;p&gt;I&#39;m in view!&lt;/p&gt;}
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

export default App;</code>
        </deckgo-highlight-code>
<p>Once this is all wired up, run <code>yarn start</code> and open your developer console. When the app first loads you should see that the state is first false, then when we scroll to the selected div, the state turns to true!</p>
<p>Thanks for reading and be sure to let me know if you've enjoyed this tutorial!</p>
<p>Shortly I'll post another that shows how to use this to animate elements onto the screen using GSAP.</p></div></div></div><div class="Components__Container-sc-d0qytj-5 bFxuRb"><div class="Footer__FooterContainer-sc-p7cnj8-2 byTVWE"><div class="Footer__LeftFooter-sc-p7cnj8-1 MgiYm"><a class="Components__StyledWebsiteName-sc-d0qytj-6 fgsjJZ" href="/">billyjacoby.com</a><p>thanks for visiting my website. I hope you found something that can be at least a little helpful to you in your journey!</p></div><div class="Footer__RightFooter-sc-p7cnj8-0 egdjOs"><a href="https://discordapp.com/users/billyjacoby/7369" target="_blank" class="Components__StyledLink-sc-d0qytj-8 gEBbCI"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><path d="M6.552 6.712c-.456 0-.816.4-.816.888s.368.888.816.888c.456 0 .816-.4.816-.888.008-.488-.36-.888-.816-.888zm2.92 0c-.456 0-.816.4-.816.888s.368.888.816.888c.456 0 .816-.4.816-.888s-.36-.888-.816-.888z"></path><path d="M13.36 0H2.64C1.736 0 1 .736 1 1.648v10.816c0 .912.736 1.648 1.64 1.648h9.072l-.424-1.48 1.024.952.968.896L15 16V1.648C15 .736 14.264 0 13.36 0zm-3.088 10.448s-.288-.344-.528-.648c1.048-.296 1.448-.952 1.448-.952-.328.216-.64.368-.92.472-.4.168-.784.28-1.16.344a5.604 5.604 0 0 1-2.072-.008 6.716 6.716 0 0 1-1.176-.344 4.688 4.688 0 0 1-.584-.272c-.024-.016-.048-.024-.072-.04-.016-.008-.024-.016-.032-.024-.144-.08-.224-.136-.224-.136s.384.64 1.4.944c-.24.304-.536.664-.536.664-1.768-.056-2.44-1.216-2.44-1.216 0-2.576 1.152-4.664 1.152-4.664 1.152-.864 2.248-.84 2.248-.84l.08.096c-1.44.416-2.104 1.048-2.104 1.048s.176-.096.472-.232c.856-.376 1.536-.48 1.816-.504.048-.008.088-.016.136-.016a6.521 6.521 0 0 1 4.024.752s-.632-.6-1.992-1.016l.112-.128s1.096-.024 2.248.84c0 0 1.152 2.088 1.152 4.664 0 0-.68 1.16-2.448 1.216z"></path></svg></a><a href="https://twitter.com/billyjacoby" target="_blank" class="Components__StyledLink-sc-d0qytj-8 gEBbCI"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"></path></svg></a><a href="https://www.linkedin.com/in/williamjacoby/" target="_blank" class="Components__StyledLink-sc-d0qytj-8 gEBbCI"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><a href="https://github.com/billyjacoby" target="_blank" class="Components__StyledLink-sc-d0qytj-8 gEBbCI"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/intersectionobserver-api-with-react-hooks/";window.___webpackCompilationHash="2325faabc1fce995739b";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-cb9afff8dadf22387043.js"],"app":["/app-ff219bc539930b87f672.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-dab4998022975baf8fbe.js"],"component---src-pages-blog-tsx":["/component---src-pages-blog-tsx-7f10d239e336018c9a85.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-9eec53dee115b63230d9.js"],"component---src-pages-markdown-remark-frontmatter-slug-tsx":["/component---src-pages-markdown-remark-frontmatter-slug-tsx-2b62b90352fefcaa5f6c.js"]};/*]]>*/</script><script src="/polyfill-cb9afff8dadf22387043.js" nomodule=""></script><script src="/app-ff219bc539930b87f672.js" async=""></script><script src="/framework-0398b9538db83a4eb219.js" async=""></script><script src="/webpack-runtime-5950a1e53ff064c187a5.js" async=""></script></body></html>